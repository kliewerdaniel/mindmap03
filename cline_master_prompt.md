# CLINE_MASTER_PROMPT.md

# Mind Map AI — CLIne Master Builder Prompt

---

## 1. Project Overview

**Project Name:** Mind Map AI  
**Purpose:** Build a fully local, LLM-powered personal knowledge graph system that ingests text or markdown notes, extracts entities, relationships, and concepts, stores them in a NetworkX graph with SQLite for provenance, and provides an interactive Next.js frontend for exploration and editing.  

**Core Goals:**
- Entirely local: LLM inference, database, and graph processing are all on-device.
- Incremental iterative development via CLIne prompts.
- Maintain comprehensive documentation that guides development and adapts with project changes.
- Track every step, task, and deliverable in a `checklist.md` for observability and iterative progress.

---

## 2. Technologies & Architecture

**Frontend:** Next.js (React), react-cytoscapejs for graph visualization  
**Backend:** FastAPI (Python)  
**Graph Processing:** NetworkX, persisted with `.gpickle` / GraphML  
**Database:** SQLite for raw text, metadata, and provenance  
**LLM:** Local model (Ollama, LLaMA, or similar)  
**Vector Embeddings:** Local sentence-transformers or Chroma/Faiss  
**Visualization:** Cytoscape.js via React wrapper  
**Optional DevOps Tools:** Docker for local containers, Git for version control  

**High-Level Architecture Diagram:**

[ Next.js Frontend ] <—> [ FastAPI Backend ] <—> [Local LLM Runtime]
|– SQLite (notes + extracts)
|– NetworkX Graph (.gpickle / GraphML)
|– Vector DB (local Chroma/Faiss embeddings)

---

## 3. Documentation Framework

All documentation should be generated by CLIne initially and updated incrementally as the project evolves. Documentation must live in `/docs/`.

**Files to generate:**
- `architecture.md` — diagrams, system overview, folder structure
- `api-spec.md` — REST endpoint descriptions, request/response formats
- `database.md` — SQLite schema, table definitions
- `llm_prompting.md` — prompt schemas, extraction JSON format
- `security.md` — authentication, API security, local privacy
- `cicd_devops.md` — Docker setups, local dev environment, CI/CD notes
- `testing.md` — unit, integration, end-to-end testing guidelines
- `design_system.md` — UI/UX rules, graph visualization patterns
- `roadmap.md` — planned features, incremental goals
- `decisions.md` — track architectural and implementation choices
- `changelog.md` — versioned project changes

**Documentation Rules:**
- Every CLIne prompt must reference `/docs/` files.
- Changes to the system (API, DB, frontend) must be reflected in the corresponding documentation.
- Documentation must include sample JSON, diagrams, code snippets, and usage instructions.
- CLIne must create `.md` files even with placeholders for sections not yet implemented.

---

## 4. Checklist System (`checklist.md`)

CLIne must maintain a master checklist that includes **all tasks, deliverables, thresholds, and progress**.  

**Checklist Format Example:**
```markdown
# Mind Map AI Checklist

## Prompt 1: Initialize Repository & Documentation
- [ ] Create folder structure (`/frontend`, `/backend`, `/docs`, `/data`, `/tests`)
- [ ] Generate initial documentation templates in `/docs/`
- [ ] Initialize `checklist.md` with this entry
- [ ] Commit initial repo structure

Rules for CLIne:
	•	Append each prompt and its tasks to checklist.md.
	•	Update checkboxes [ ] → [x] when tasks are complete.
	•	Reference documentation in each prompt to stay consistent with system changes.
	•	Include deliverables and completion thresholds in each prompt.

⸻

5. CLIne Workflow Rules
	1.	Documentation-First: CLIne must create and maintain /docs/ files before or alongside implementation.
	2.	Incremental Prompts: Each CLIne prompt must be fully executable on its own, without assumptions of external context, but referencing /docs/.
	3.	Deliverables & Thresholds: Each prompt must specify output files, expected behavior, and conditions for marking completion.
	4.	Observability: CLIne must log all actions, decisions, and modifications into decisions.md and changelog.md.
	5.	Version Control: CLIne must maintain clear commit points per prompt.
	6.	Local-Only Constraint: No remote LLM calls unless explicitly configured; default operation is fully offline.

⸻

6. Incremental CLIne Prompts

✅ Prompt 1 — Initialize Repository & Documentation

Objective: Set up project structure, create documentation templates, initialize checklist.md.

Tasks:
	•	Create /frontend, /backend, /docs, /data, /tests.
	•	Generate documentation placeholders:
	•	/docs/architecture.md
	•	/docs/api-spec.md
	•	/docs/database.md
	•	/docs/llm_prompting.md
	•	/docs/security.md
	•	/docs/cicd_devops.md
	•	/docs/testing.md
	•	/docs/design_system.md
	•	/docs/roadmap.md
	•	/docs/decisions.md
	•	/docs/changelog.md
	•	Initialize checklist.md and add this prompt as entry.
	•	Commit initial structure to Git.

Deliverables:
	•	Directory structure as above.
	•	Placeholder .md files in /docs/.
	•	Initialized checklist.md.

Completion Threshold:
	•	All directories and placeholder docs exist.
	•	Checklist entry added.
	•	CLIne logs creation in decisions.md.

⸻

✅ Prompt 2 — Backend Setup & SQLite Schema

Objective: Initialize FastAPI backend and SQLite database with schema.

Tasks:
	•	Create /backend/app/main.py with FastAPI instance.
	•	Define /backend/app/db/schema.sql with notes, extracts, metadata tables.
	•	Implement DB connection module (/backend/app/db/db.py).
	•	Add initial requirements.txt for Python dependencies.
	•	Add tasks to checklist.md referencing backend initialization.

Deliverables:
	•	FastAPI project skeleton.
	•	SQLite schema created.
	•	DB connection module functional.

Completion Threshold:
	•	FastAPI server runs locally without errors.
	•	SQLite database can be created and queried.
	•	Checklist entry updated [x] when complete.

⸻

✅ Prompt 3 — NetworkX Graph Setup & Persistence

Objective: Implement in-memory graph using NetworkX and persistence to disk.

Tasks:
	•	Create /backend/app/services/graph_store.py managing NetworkX graph.
	•	Implement node and edge creation, update, deletion.
	•	Persist graph to .gpickle and GraphML.
	•	Include sample load and save scripts.
	•	Document graph storage in /docs/database.md and /docs/architecture.md.

Deliverables:
	•	Fully functional NetworkX graph module.
	•	Sample persistence files.

Completion Threshold:
	•	Graph can be saved and reloaded.
	•	Checklist entry updated.

⸻

✅ Prompt 4 — LLM Extraction Module

Objective: Implement local LLM integration for extracting nodes and edges from text.

Tasks:
	•	Create /backend/app/services/extractor.py.
	•	Implement function to call local LLM with structured JSON output.
	•	Handle canonicalization of node labels.
	•	Write unit tests to validate extraction.
	•	Document JSON schema in /docs/llm_prompting.md.

Deliverables:
	•	Extractor module functional.
	•	Test cases for extraction correctness.

Completion Threshold:
	•	Given sample text, LLM produces valid JSON nodes/edges.
	•	Checklist updated.

⸻

✅ Prompt 5 — Embeddings & Vector Store

Objective: Add embeddings and semantic search.

Tasks:
	•	Generate embeddings for notes and nodes using local sentence-transformer.
	•	Store vectors in local Chroma or Faiss DB.
	•	Implement semantic search API endpoint (/api/search/semantic).
	•	Update /docs/architecture.md with vector store design.

Deliverables:
	•	Embedding module functional.
	•	Search API endpoint returns top-k results.

Completion Threshold:
	•	Test queries return expected nodes.
	•	Checklist updated.

⸻

✅ Prompt 6 — Frontend Graph Visualization

Objective: Implement Next.js frontend for graph exploration.

Tasks:
	•	Create /frontend/src/pages/graph.js.
	•	Implement GraphCanvas component using react-cytoscapejs.
	•	Node click opens details panel.
	•	Sync frontend with backend API.
	•	Document UI design in /docs/design_system.md.

Deliverables:
	•	Interactive graph visualization.
	•	Node panel shows provenance and metadata.

Completion Threshold:
	•	Graph renders sample NetworkX data.
	•	Node interactions functional.
	•	Checklist updated.

⸻

✅ Prompt 7 — Note Ingestion UI

Objective: Allow users to upload markdown/text notes.

Tasks:
	•	Implement /frontend/src/components/NoteUploader.jsx.
	•	Connect uploader to backend /api/ingest/text.
	•	Validate uploads and display ingestion progress.
	•	Document in /docs/design_system.md.

Deliverables:
	•	Upload UI functional.
	•	Successful ingestion updates graph.

Completion Threshold:
	•	Upload sample notes → nodes/edges appear in graph.
	•	Checklist updated.

⸻

✅ Prompt 8 — API Security & Local Privacy

Objective: Ensure API and local data are secure.

Tasks:
	•	Add input validation for API endpoints.
	•	Implement authentication if multi-user mode.
	•	Ensure database files and embeddings are only accessible locally.
	•	Document security measures in /docs/security.md.

Deliverables:
	•	API endpoints protected.
	•	Local-only constraints enforced.

Completion Threshold:
	•	No unauthorized access possible.
	•	Checklist updated.

⸻

✅ Prompt 9 — Testing Infrastructure

Objective: Add unit, integration, and end-to-end testing.

Tasks:
	•	Implement /tests/backend/test_db.py, /test_extractor.py, /test_graph.py.
	•	Frontend tests for key components.
	•	Integrate pytest or similar.
	•	Document testing strategy in /docs/testing.md.

Deliverables:
	•	Tests pass locally.
	•	Checklist updated.

Completion Threshold:
	•	90% of core backend functions covered.
	•	Checklist updated.

⸻

✅ Prompt 10 — CI/CD & DevOps

Objective: Prepare local CI/CD workflow and devops scripts.

Tasks:
	•	Add Dockerfiles for frontend and backend.
	•	Add docker-compose.yml for local stack.
	•	Document setup in /docs/cicd_devops.md.
	•	Include instructions for starting full local environment.

Deliverables:
	•	Working Docker Compose environment.
	•	CI/CD documentation complete.

Completion Threshold:
	•	Entire stack runs locally with one command.
	•	Checklist updated.

⸻

7. Rules for All Future CLIne Prompts
	•	Reference documentation /docs/ before making changes.
	•	Update checklist.md and decisions.md with every change.
	•	Provide clear deliverables and completion thresholds.
	•	Use incremental, isolated prompts for every new feature or fix.
	•	Maintain full local-only operation.
	•	Always generate `.md files for any new modules or updates.  
	-	Each prompt must include `[ ]` checkboxes for each task and mark `[x]` when complete.  
	-	CLIne must never overwrite existing files without backup or logging changes in `decisions.md`.  
	-	Each prompt should assume the previous prompts have executed successfully and the checklist is up-to-date.  

---

## 8. Folder Structure Reference

/frontend
/src
/pages
/components
next.config.js
/backend
/app
main.py
/db
db.py
schema.sql
/services
graph_store.py
extractor.py
/api
endpoints.py
/data
/graphs
/embeddings
/docs
architecture.md
api-spec.md
database.md
llm_prompting.md
security.md
cicd_devops.md
testing.md
design_system.md
roadmap.md
decisions.md
changelog.md
/tests
backend
test_db.py
test_extractor.py
test_graph.py
frontend
test_graph_ui.jsx
checklist.md
CLINE_MASTER_PROMPT.md

---

## 9. Deliverables Summary

- **`CLINE_MASTER_PROMPT.md`** – master instructions for CLIne.  
- **`/docs/`** – full documentation suite.  
- **`/backend/app`** – backend FastAPI + NetworkX + LLM modules.  
- **`/frontend/src`** – Next.js frontend with graph visualization and note ingestion UI.  
- **`checklist.md`** – iterative task tracker with checkboxes, deliverables, and thresholds.  
- **`/data`** – persistent storage for SQLite, NetworkX graphs, and embeddings.  
- **`/tests`** – unit, integration, and end-to-end tests.  
- **Docker & DevOps files** – enable local reproducible environment.

---

## 10. Observability & Iterative Improvements

- **Decisions & Rationale**: `decisions.md` tracks architectural decisions and their justification.  
- **Changelog**: `changelog.md` records versioned updates with date, author, and impact.  
- **Checklist Updates**: Every CLIne prompt must update `checklist.md` with tasks completed.  
- **Documentation Syncing**: CLIne must reference `/docs/` in every prompt to ensure consistency and update any affected sections.  
- **Error Handling & Logging**: Backend modules should log all errors to `/data/logs.log` and notify via console during local execution.

---

## 11. Incremental Development Philosophy

1. **Documentation First** – Define architecture, API, DB schema, and LLM JSON formats before implementation.  
2. **Local-Only** – All processing, embeddings, and inference must remain on-device.  
3. **Modular Prompts** – Each CLIne prompt addresses a single subsystem or feature.  
4. **Observability** – All tasks, decisions, and changes must be logged in `/docs/` or `checklist.md`.  
5. **Checkpoints** – Deliverables and success thresholds must be explicitly stated for every task.

---

## 12. Example Future Prompts

- **Prompt 11** – Interactive Graph Editing: Add node/edge create, edit, delete in frontend and backend.  
- **Prompt 12** – Semantic Search Enhancements: Advanced query filters, similarity scoring, and result ranking.  
- **Prompt 13** – Graph Export/Import: Support JSON, CSV, and GraphML for interoperability.  
- **Prompt 14** – UI Enhancements: Dark mode, node coloring, and cluster visualization.  
- **Prompt 15** – Multi-user Mode: Local authentication and personal graph spaces (optional).  
- **Prompt 16** – Advanced LLM Prompt Optimization: Modular prompt chaining and improved extraction accuracy.  
- **Prompt 17** – Backup & Recovery: Automated local graph and DB backup routines.  
- **Prompt 18** – Metrics & Observability Dashboard: Visualize ingestion rates, graph growth, extraction success.  
- **Prompt 19** – Local Plugin System: Allow CLIne to extend modules via local plugin scripts.  
- **Prompt 20** – Full Test Suite Integration: Coverage reports, CI scripts, and automated testing for all modules.

---

## 13. Notes for CLIne Execution

- Each prompt is **self-contained but sequentially aware**.  
- All tasks require clear **deliverables** and a **success threshold**.  
- CLIne must maintain **full observability** through `/docs/`, `checklist.md`, and `decisions.md`.  
- Every prompt update should result in updated Markdown documentation reflecting the current system state.  
- Prompts should **encourage modular, local-first development** to ensure reproducibility and offline operation.

---

## 14. CLIne Execution Log